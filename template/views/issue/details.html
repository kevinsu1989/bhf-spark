<div>
<article class="issue-details" issue-details id="issue-details">
    <div class="not-found" ng-show="notFound">
        <p>
            <i class="icon"></i>
            404 Not Found
        </p>
    </div>
    <div ng-show="!notFound" class="full">
        <div style="overflow: auto; height: 100%; position:relative;">
            <!--展示一个issue的所有内容-->
            <header ng-hide="articleOnly">
                <div class="project-name">
                    <i class="small icon cell"></i>
                    <label>{{project.title}}</label>
                </div>
                <div class="owner" dropdown data-name="issue:owner" data-text-container="label.display" data-selected="{{issue.owner}}">
                    <i class="icon small cell"></i>
                    <label class="display">{{issue.owner_name || '未指定'}}</label>
                    <project-member-dropdown data-items="{{projectMember}}"></project-member-dropdown>
                </div>
                <div class="finish-date">
                    <button datetime-picker  data-name="plan_finish_time" data-date="{{issue.plan_finish_time | date:'yyyy-MM-dd'}}">
                        <i class="icon small cell"></i>
                        <span>　{{(issue.plan_finish_time | date:'yyyy-MM-dd') || '未指定' }}</span>
                    </button>
                </div>
                <div class="priority" dropdown data-name="issue:priority" data-text-container="label.display" data-selected="{{issue.priority}}">
                    <i class="icon small cell"></i>
                    <label class="display">中</label>
                    <issue-priority-dropdown data-project-id="{{issue.project_id}}" data-id="{{issue.id}}"></issue-priority-dropdown>
                </div>
                <div class="category" dropdown data-name="issue:category" data-text-container="label.display" data-selected="{{issue.category_id}}" data-formatter="分类：{0}">
                    <i class="icon small cell"></i>
                    <label class="display">分类</label>
                    <project-category-dropdown data-project-id="{{issue.project_id}}" data-id="{{issue.category_id}}"></project-category-dropdown>
                </div>

                <div class="version" dropdown data-name="issue:version" data-text-container="label.display" data-selected="{{issue.version_id}}" data-formatter="版本: {0}">
                    <i class="icon small cell"></i>
                    <label class="display">版本</label>
                    <project-version-dropdown data-show-create="false"></project-version-dropdown>
                </div>
                <!--
                <div class="assets">
                    <i class="icon small cell"></i>
                    <label>附件</label>
                </div>
                <div class="trash">
                    <i class="icon small cell"></i>
                    <label>删除</label>
                </div>
                -->
            </header>

            <!--标题部分-->
            <div class="issue panel" ng-click="onClickIssue($event)">
                <div class="title">
                    <div class="issue-status" dropdown data-selected="{{issue.status}}" data-name="issue:status">
                        <i class="issue-status icon small" ng-class="issue.status"></i>
                        <issue-status-dropdown></issue-status-dropdown>
                    </div>
                    <input type="text" class="text" ng-show="editing" ng-model="issue.title" />
                    <h3 ng-show="!editing">{{issue.title}}</h3>

                    <div class="toolbar">
                        <a ng-click="onClickEdit($event, data)" href="javascript:void(0)" class="edit">编辑</a>
                        <a ng-click="onClickDelete($event, data)" href="javascript:void(0)" class="delete">删除</a>
                    </div>
                </div>
                <div class="sub-title">
                    <span class="creator">{{issue.creator_name || '创建者'}}</span>
                    <span class="tag">标签</span>
                    <span class="timestamp">{{issue.timestamp | date: 'yyyy-MM-dd hh:mm'}}</span>
                    <span class="id">#{{issue.id}}</span>
                </div>
                <div class="content row" ng-bind-html="issue.content | unsafe" ng-show="!editing"></div>
                <div ng-show="editing">
                    <editor data-name="issue" data-show-always-top="{{showAlwaysTop}}" data-upload-url="{{uploadUrl}}"></editor>
                </div>
            </div>

            <!--附件-->
            <div class="assets panel" ng-hide="articleOnly">
                <div class="title">
                    <i class="icon small"></i>
                    <h3>附件</h3>
                </div>
                <div class="content">
                    <!--附件缩略图列表-->
                    <asset-thumbnails></asset-thumbnails>
                    <button class="create" upload-assets></button>
                    <div class="file_upload_box"></div>
                </div>
            </div>

            <!--评论-->
            <div class="comments panel">
                <div class="title">
                    <i class="icon small"></i>
                    <h3>评论</h3>
                </div>
                <div class="content">
                    <comment-list></comment-list>
                </div>
            </div>

            <!--日志-->
            <div class="logs panel" ng-hide="articleOnly">
                <div class="title">
                    <i class="icon small"></i>
                    <h3>记录</h3>
                </div>

                <div class="content">
                    <issue-log></issue-log>
                </div>
            </div>
        </div>
        
    </div>
</article>
<comment-editor data-upload-url="{{uploadUrl}}"></comment-editor>
</div>
