(function(){var e={}.hasOwnProperty,t=function(t,n){function o(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t};!function(e){return"function"==typeof define&&define.amd?define(["marked"],e):e(window.marked)}(function(e){var n;return n=function(n){function o(){if(o.__super__.constructor.apply(this,arguments),this.marked=e,!e)throw new Error("cannot find the plugin marked")}return t(o,n),o.prototype.name="marked",o.prototype.title="marked",o.prototype.icon="maxcdn",o.prototype.shortcut="ctrl+77",o.prototype.decodeHTML=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.innerText},o.prototype.encodeHTML=function(e){var t;return t=document.createElement("div"),t.appendChild(document.createTextNode(e)),t.innerHTML},o.prototype.decodeCodes=function(e){var t,n,o,r,i,d;for(o=document.createElement("div"),o.innerHTML=e,n=o.querySelectorAll("code"),i=0,d=n.length;d>i;i++)t=n[i],r=this.decodeHTML(t.innerText),t.innerText=r;return o.innerHTML},o.prototype.replaceSelection=function(e,t){var n,o,r,i,d,c,a;if(null==t&&(t=!0),a=window.getSelection(),a.getRangeAt&&a.rangeCount){if(c=window.getSelection().getRangeAt(0),c.deleteContents(),c.createContextualFragment)i=c.createContextualFragment(e);else for(o=document.createElement("div"),o.innerHTML=e,i=document.createDocumentFragment();n=o.firstChild;)i.appendChild(n);if(r=i.firstChild,d=i.lastChild,c.insertNode(i),t)return r&&(c.setStartBefore(r),c.setEndAfter(d)),a.removeAllRanges(),a.addRange(c)}},o.prototype.doReplaceSelction=function(e){var t;return t=this.marked(this.encodeHTML(e)),t=this.decodeCodes(t),this.replaceSelection(t)},o.prototype.doReplaceAll=function(){var e;return e=this.editor.getValue(),e=e.replace(/<p>/g,"").replace(/<\/p>/g,"\n"),e=this.marked(e),e=this.decodeCodes(e),this.editor.setValue(e)},o.prototype.command=function(){var e;return e=window.getSelection().toString(),0===e.length?this.doReplaceAll():this.doReplaceSelction(e),this.editor.selection.setRangeAtEndOf("p")},o}(SimditorButton),Simditor.Toolbar.addButton(n)})}).call(this);